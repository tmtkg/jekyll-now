---
layout: post
title: PHPカンファレンス2015
---

## 開催概要
+ 日時：2015/10/3(木)
+ 場所：大田区産業プラザ PiO

---

## Inside CyberAgent's Game Development
+ スピーカー：㈱サイバーエージェント　白井 英氏（前半）
+ スピーカー：㈱グリフォン　川村 猛氏（後半）

### サイバーエージェントの技術変遷
+ 2010年　ソーシャルアプリ黎明期
  - 『ドリームプロデューサー』、『星空バータウン』などのガラケー向けソーシャルアプリを発表　
    - ガラケーなのに、混雑時は200Mbpsとトラフィック量が多かった
  - サーバはオンプレ（Puppet）、フレームワークはCakePHPを使用。デプロイには Capistranoを利用。Subversion管理

+ 2012～2013年　ブラウザゲーム隆盛期
  - オンプレからクラウドに。フレームワークはCodeIgniterを使用。チケット発行はRedmineを使用
　
+ 2013～2014年　転換期
  - 子会社のひとつ（CyberX）が、開発の主流をPHPからNode.jsへ変更
    - 開発のしやすさを見直す目的があった
  - 結合テストを自動化した
    - 参考：『CakePHP+Jankinsによるアジャイル開発』https://speakerdeck.com/ryuzee/cakephp-plus-jenkinsniyoruaziyairukai-fa-number-phpmats
  - Gitを導入することで、プログラムレビューができるようになった
  - 継続的デリバリー

+ 現在
  - サーバはAWS（オペレーション効率化）、自社プライベートクラウド（コストメリット）、GAE（Googleと仲良くなれた）
  - WAF（Web Application Firewall）はPhalcom
  - GitプラグインにはGit-flow（gitのブランチを使うときのルールをまとめたもの）を使用
  - 振り返ってみると、Webアプリからネイティブアプリへ主流が移っても、サーバエンジニアに関する変化は少なかった


### PHPに命を救われた話
+ ネイティブアプリが主流となった今でも、CAの子会社グリフォンはWebアプリの制作がメイン。言語はすべてPHP
+ グリフォン設立後初めてリリースしたアプリが2ヶ月でクローズし、倒産の危機
  - セキュリティ対策（XSS、CSRF、SQLインジェクション）が不十分
  - 実行速度に問題あり
+ PHPにシフト
  - CA内でPHPでソーシャルアプリの開発・運用経験（過去3年）
    - 8名のエンジニアで着手?リリース4ヶ月（好ペースなのだそう）
  - 過去のノウハウから、スピードアップと安定性を得た

---

## フリマアプリ「メルカリ」の急成長を支えるエンジニアリング
+ スピーカー：株式会社メルカリ　久保 達彦氏
  - https://speakerdeck.com/cubicdaiya/hurimaapuri-merukari-falseji-cheng-chang-wozhi-eruenziniaringu

+ インフラ構成
  - さくら（専用サーバ、クラウド）とAWSのハイブリッド
  - 専用サーバは1台あたりの性能が高いため台数少なくてもOK＝コストメリット
  - クラウドは柔軟性が高い。突発的な負荷への対応や、サーバ確保の容易さ

+ PHPで高速なAPIサーバを実現
  - 軽量フレームワーク：DietCake
  - キャッシュ：memcached、Redis
  - 非同期処理：Q4M+php-Parallel-Prefork
  - MySQL on ioDrive
  - モニタリング：New Relic
　- PHPのバージョンを2015/7に5.3から5.6に。レスポンス能力が向上した

+ nginxによるハイパフォーマンスネットワーキング
  - 高速なHTTPS通信の提供で、大量の同時接続を捌くことができる
  - 参考：『nginxのパフォーマンスチューニング』https://speakerdeck.com/cubicdaiya/nginxfalsepahuomansutiyuningu
	
+ SlackでChatOps（＝チャットを共有のコマンドラインとして扱うもの）
  - メルカリでは、Slackを使ってデプロイ、勤怠管理、アラート通知、CIの手動実行などを行っている
　  - しかし、様々なサーバからSlackに通知する際には問題もある
　　- これを解消するためにプロキシを立ててプロキシと通信するクライアントを各サーバに配置する予定

+ 今とこれから
  - 2016年はPHP7対応を行う予定
  - バックエンドではGoを採用する場面が増えている
  - システムの自動化などを支えるための基盤づくりに勤しむ

---

## いまどきのPHP開発現場-2015年秋-
+ スピーカー：1x1株式会社　新原 雅司氏
  - http://www.slideshare.net/shin1x1/php-2015-53486408

### 開発端末導入系
+ PHP Storm（有償IDE）
  - 補完機能が優秀（1文字で補完、継承などコンテキストを理解して補完）
  - コードの整形に優れている

+ Vagrant（仮想環境構築ツール）
  - 仮想マシンを利用して、プロジェクト毎に自動で環境構築ができる
  - チームで同じ環境を利用することができる
  - 運用環境と同じものが作りやすい


### フレームワーク
+ Laravel
  - Symfonyコンポーネントを多数利用したいいとこどりフレームワーク
  - フレームワークに従うのではなく、アプリの部品として使う
  - フレームワークのための「べき論」は主従が逆転している


### CI（継続的インテグレーション）
+ ※CI…ビルドやテストなどを継続的に実行していくこと。XcodeもCIのひとつ

+ Travis CI
  - GitHubとしか連携することができない
  - しかし、sudoが実行できるのでなんでもできる

+ Scrutinizer（SaaS）
  - コードフォーマットや静的解析をする
  - 有償ならテスト実行もできる

### PaaS
+ ※PaaS…アプリが稼動するためのハードウェアやOSなどの基盤一式を、インターネット上のサービスとして遠隔から利用できるようにしたもの

+ Heroku
  - HerokuがPHPを正式サポート（2014年～）
  - サーバメンテナンス不要。セットアップは自動
  - Gitでデプロイすることですぐに使用できる

### ツールやサービスに任せることの重要性
+ やるべきことに注力する。自分でなんでもかんでもやろうとしない
+ ツールを使うことで、知見が広まる
  - 使い続けることで、ノウハウとして身につく

---

## 脆弱性もバグ、だからテストしよう
+ スピーカー：株式会社ビットフォレスト　市川 快氏
  - http://www.slideshare.net/ichikaway/php2015-53484885

### リスクの割にはセキュリティテストが普及していない
+ リファクタリングしたときにセキュリティテストが自動実行されるといい
  - こうすることで、担当者が変わってもセキュリティ面で発生する問題を減少することができる
+ セキュリティ教育には、IPA『安全なウェブサイトの作り方』、徳丸浩『体系的に学ぶ 安全なWebアプリケーションの作り方』がおすすめ
+ セキュリティ対策の現状問題として、ツールの設定を学び続けなければならないので開発に注力できない
  - VAddyは、無料で機械学習を使ったセキュリティ診断。CI連携も可能（参考：http://vaddy.net/ja/）

---

## PHPカンファレンス2015 スライドまとめ
+ http://sprawl.hatenablog.jp/entry/2015/10/03/234934
